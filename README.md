# LabStreamingLayer Timing Test

This is a script to help measure the [constant delay](https://sccn.ucsd.edu/~mgrivich/LSL_Validation.html) of your recording hardware when recording over LSL. It requires an [RTBox](https://github.com/xiangruili/RTBox_py) to send TTL pulses and, importantly, to yield accurate timestamps for when those TTLs were actually delivered on LSL's local clock.

This should work reasonably well for any device that has an LSL plugin that (1) uses LSL's `local_clock()` to record timestamps and (2) records the time of retrieved TTL triggers. (Not all LSL plugins will record TTL triggers; for example, the plugin for [EGI's amp server](https://github.com/labstreaminglayer/App-EGIAmpServer) doesn't record digital events without [modification](https://github.com/apex-lab/App-EGIAmpServer400), but the one for [Brain Products' actiCHamp](https://github.com/brain-products/LSL-actiCHamp) does.)

Just start recording an LSL stream from your hardware's plugin, then run `timing-test.py` which will start a seperate marker stream. Record both streams with [LabRecorder](https://github.com/labstreaminglayer/App-LabRecorder). Then you just have to load the resulting XDF file and compute the offset (and jitter) between the hardware events and the software markers as in the example `timing-test.ipynb`. The way in which the EEG plugin records the timing of triggers can vary between systems; in the example, they are encoded as an additional data channel containing 8-bit integers (cast to floats to match the EEG data), recording the binary state of the 8-channels of digital inputs.
